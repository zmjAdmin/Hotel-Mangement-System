<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ccu.server.dao.RoomDao">

    <resultMap type="com.ccu.server.entity.Room" id="RoomMap">
        <result property="roomId" column="room_id" jdbcType="INTEGER"/>
        <result property="roomNo" column="room_no" jdbcType="VARCHAR"/>
        <result property="roomTypeId" column="room_type_id" jdbcType="INTEGER"/>
        <result property="roomPicture" column="room_picture" jdbcType="VARCHAR"/>
        <result property="roomStatus" column="room_status" jdbcType="VARCHAR"/>
        <result property="roomDel" column="room_del" jdbcType="INTEGER"/>
    </resultMap>

    <!--查询所有字段-->
    <sql id="queryAllColumn">
        select `room_id`,
               `room_no`,
               `room_type_id`,
               `room_picture`,
               `room_status`,
               `room_del`
        from hotel2.room
    </sql>

    <!--所有的where条件-->
    <sql id="whereAll">
        <where>
            <if test="roomId != null">
                and room_id = #{roomId}
            </if>
            <if test="roomNo != null and roomNo != ''">
                and room_no = #{roomNo}
            </if>
            <if test="roomTypeId != null">
                and room_type_id = #{roomTypeId}
            </if>
            <if test="roomPicture != null and roomPicture != ''">
                and room_picture = #{roomPicture}
            </if>
            <if test="roomStatus != null and roomStatus != ''">
                and room_status = #{roomStatus}
            </if>
            <if test="roomDel != null">
                and room_del = #{roomDel}
            </if>
        </where>
    </sql>

    <!--除主键外所有set条件-->
    <sql id="setAll">
        <set>
            <if test="roomNo != null and roomNo != ''">
                room_no = #{roomNo},
            </if>
            <if test="roomTypeId != null">
                room_type_id = #{roomTypeId},
            </if>
            <if test="roomPicture != null and roomPicture != ''">
                room_picture = #{roomPicture},
            </if>
            <if test="roomStatus != null and roomStatus != ''">
                room_status = #{roomStatus},
            </if>
            <if test="roomDel != null">
                room_del = #{roomDel},
            </if>
        </set>
    </sql>

    <!--查询所有数据-->
    <select id="queryAll" resultMap="RoomMap">
        <include refid="queryAllColumn"/>
        <include refid="whereAll"/>
    </select>

    <!--通过主键查询单条数据-->
    <select id="queryById" resultMap="RoomMap">
        <include refid="queryAllColumn"/>
        where room_id = #{roomId}
    </select>

    <!--插入一条数据-->
    <insert id="insert" keyProperty="roomId" useGeneratedKeys="true">
        insert into hotel2.room(room_no, room_type_id, room_picture, room_status, room_del)
        values (#{roomNo}, #{roomTypeId}, #{roomPicture}, #{roomStatus}, #{roomDel})
    </insert>

    <!--通过主键修改数据-->
    <update id="update">
        update hotel2.room
        <include refid="setAll"/>
        where room_id = #{roomId}
    </update>

    <!--通过主键删除数据-->
    <delete id="deleteById">
        delete
        from hotel2.room
        where room_id = #{roomId}
    </delete>

    <!--统计总行数-->
    <select id="count" resultType="java.lang.Long">
        select count(1)
        from room
        <include refid="whereAll"/>
    </select>

</mapper>
